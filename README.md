# Database-Management-Project

This project is a University project and that's why it's in Romanian. <br />
I have attached the Entity Relationship Diagram in English just here for a better understanding of the concepts.
<br />
![ERD](https://user-images.githubusercontent.com/93484228/221360837-25e5ef63-c0dd-4ea6-bdf4-e37da4fff61a.png)
<br />
<br />

# About the project <br />
This project tries to maintain a prototype database for all the Romanian cinemas that belong to the 'Cinema City' big chain of cinemas. <br />
<br />
<br />


# Table of contents <br />
    &emsp;&emsp;&emsp;-> **ex4**: contains the code from the **creation** of all the tables that are used in this database, along with all the **required constraints** <br />
    &emsp;&emsp;&emsp;-> **ex5**: contains the code from the **insertion** of the needed data in all the tables that are found in this database <br />
    &emsp;&emsp;&emsp;-> **ex6**: contains a **procedure** in which I have used as many **types of collections** as I could (I have **nested tables**, **nested tables of record**, **varrays**, and **indexed tables**). This procedure displays for each cinema the top of the best three rated movies that are projected in it. That Classement is determined by the following: if that cinema hasn't projected at least three movies then I will display the message that I can not determine a top 3. After that step, I verify if that cinema can form a top 3 by eliminating duplicate movies and movies with the same rating (because a cinema can project 5 movies, but all of them have the same rating so it's not a top 3) <br />
   &emsp;&emsp;&emsp;-> **ex7**: contains a **procedure** in which I have used as many **types of cursors** as I could (I have **nested cursor expressions**, **explicit cursor**, **parametrized cursor**, **cursor cycle**, **cursor cycle with subrequests**, **ref cursor**). This procedure accepts two types of operations. For option 1, all existing cinemas in the database will be listed, together with coherent information about the employment situation within the respective cinema, which means that the jobs that have positions will be displayed busy, together with the employees who work on that job, in that cinema or a message indicating that we do not have any employees registered for that cinema. For option 2, all existing cinemas in the database will be listed, specifying the number of employees who currently working in that cinema and the number of employees who worked in that cinema in the past. Also, together with the cinemas, coherent information about the employment situation within the respective cinema is displayed, which means that the jobs that have currently filled positions or that have been filled in the past and the employees will be displayed who work on that job, in that cinema, and/or who worked in the past on that job, in that cinema, along with a message specifying what kind of employee he is (Current / History). Any other number represents an incorrect option <br />
    &emsp;&emsp;&emsp;-> **ex8** : contains a **function** in which I have defined as many **exceptions** as I could and in which I have implemented a **Join that connects 3 tables** from the database (MOVIE, BROADCAST, BOUGHT_TICKET). Given the genre of a film and the year, this function returns the sum of the prices of all the tickets bought for the films that have the respective main genre and that were used to enter broadcasts that had as their starting date a year greater than the year given as a parameter. The exceptions that I have defined: <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;I.   the year is given as a parameter is negative <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;II.  the year given as a parameter is greater than the current year <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;III. for the genre given as a parameter, there are no movies in the database <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;IV.  there is no broadcast for any film with the genre given as a parameter that takes place after the year given as a parameter <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;V.   there is no ticket bought for any broadcast that took place after the year given as a parameter of any film that has the genre given as a parameter <br />
    
&emsp;&emsp;&emsp;-> **ex9**: contains a **procedure** in which I have defined as many **exceptions** as I could and I also handled **NO_DATA_FOUND** and **TOO_MANY_ROWS** exceptions and in which I have implemented a **Join that connects 5 tables** from the database (MOVIE, PLAY, BROADCAST, CINEMA, ROOM). This procedure aims to find all the data from the database that satisfies some conditions given. For complexity, I altered the MOVIE table and added a column that contains a nested table, which I know it's not good in practice. After that, I collected data about the number of persons that contributed to the distribution of movies that satisfy the required conditions. In the procedure described above, we want to display details about the cinema, it's opening day, details about the rooms where the current movie was broadcasted, the name of the current movie, and its rating. Using the additional column from the MOVIE table we will calculate an average between the number of prizes won by the people who are part of the distribution and the number by these people, this being the film's award average. The exceptions treated are: <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;I.   the year is given as a parameter is negative <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;II.  the year given as a parameter is greater than the current year <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;III. for the year given as a parameter, there are no cinemas that opened on Mondays or Saturdays <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;IV.  there is no actor with the given name as a parameter <br />
              &emsp;&emsp;&emsp;&emsp;&emsp;V.   there are several actors with the name given as a parameter <br />
    &emsp;&emsp;&emsp;-> **ex10**: contains an **LMD trigger at the command level** which makes sure that before inserting any data in the ACTOR table, all data already inserted are correct <br />
    &emsp;&emsp;&emsp;-> **ex11**: contains **two LMD triggers**, one **compound trigger for AFTER at row and command level** and one **trigger for BEFORE at row level**. Those two triggers assure that before performing any operation on the EMPLOYEE table we verify if all data already inserted are correct and after performing any operation we modify the linked tables (JOB_HISTORY, EMPLOYEE) so all data are correct. <br />
    &emsp;&emsp;&emsp;-> **ex12**: contains an **LDD trigger** that is colored by creating an **audit table** <br />
    &emsp;&emsp;&emsp;-> **ex13**: contains a **package** that includes all procedures, functions, and data used in the previous exercises <br />
    &emsp;&emsp;&emsp;-> **ex14**: contains a **package** that includes four functions, 3 procedures, 2 cursors, 1 record, one nested table of records, and one nested table of names. The "colectare_date" procedure collects coherent information in the record type table, defined within the package, by memorizing data about each cinema in the database, collecting its id and name, the name of a movie screening in that cinema, the number of screens that took place in the current cinema for the current film, the number of broadcasts, and the number of tickets bought. The number of broadcasts and tickets will be found with the help of the "nr_difuzari" and "nr_bilete" functions. The "afisare" procedure will display the data stored in the record table using the "colectare_date" procedure. The display will do it by category, listing first the case where complete data about the cinema, films, screenings, broadcasts, and tickets have been memorized (at least one complete piece of information), or if we do not have any complete data memorized. It will also be treated, if we don't have any data about films that have been played in that cinema, or we lack data about runs, broadcasts, or tickets (at least one of them has the value 0) for each movie that ran in that cinema, and then we will display the content the nested table that holds the names of the cinemas that do not even record complete information. The "modificare" procedure increases the salary of all employees who work in one of the cinemas that sold the maximum of tickets sold (calculated by us from the database). It will be checked if the new salary falls within the salary limits for the job on which that employee is, with the help of a function ("verif_sal"). The salary will increase by the maximum number of tickets sold * 0.5. Also, in the end, the number of lines affected by the UPDATE command will be displayed.


